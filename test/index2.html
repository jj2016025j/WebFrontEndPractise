<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <style>
        #visualElement {
        /* 初始樣式 */
        }
    </style>
    
    <audio id="audioElement" src="your-audio-file.mp3" controls></audio>
    <div id="visualElement">視覺效果將在這裡顯示</div>

    <script>
        // 創建一個AudioContext實例
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        // 選擇音頻和視覺元素
        const audioElement = document.getElementById('audioElement');
        const visualElement = document.getElementById('visualElement');
        const track = audioContext.createMediaElementSource(audioElement);

        // 創建一個分析器節點
        const analyser = audioContext.createAnalyser();
        track.connect(analyser);
        analyser.connect(audioContext.destination);

        // 分析音頻數據
        function update() {
        const dataArray = new Uint8Array(analyser.frequencyBinCount);
        analyser.getByteFrequencyData(dataArray);

        // 計算音量
        const volume = dataArray.reduce((acc, val) => acc + val, 0) / dataArray.length;

        // 根據音量動態調整視覺元素的CSS樣式
        visualElement.style.opacity = volume / 100;

        // 持續更新
        requestAnimationFrame(update);
        }

        // 啟動更新函數
        update();

    </script>
</body>
</html>